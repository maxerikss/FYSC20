\paragraph{Problem:} A sphere of radius $R$ carries a ``frozen-in'' polarisation $\vec{P}(\vec{r}) = kr^2 \uvec{r}$, where $k$ is a constant
and $\vec{r}$ is the vector from the center.
\begin{enumerate}[label=(\alph*)]
    \item Calculate the bound charges $\sigma_b$ and $\rho_b$.
    \item Find the $\vec{E}$ field inside and outside the sphere from the charge densities found at (a).
    \item Alternatively, compute the $\vec{E}$ field by first determining the $\vec{D}$ field using Gauss's law and then use that $\vec{D} = \epsilon_0 \vec{E} + \vec{P}$.
\end{enumerate}

\paragraph{(a) Solution:}
Start by drawing a sketch of the problem.
\begin{figure}[H]
    \centering
    \input{figures/sketch.pdf_tex}
    \caption{The problem sketch with cartesian and spherical coordinates drawn.}\label{fig:sketch}
\end{figure}
We can calculate the bound charge densities from the polarisation $\vec{P}$.
\begin{equation}
    \sigma_b = \uvec{n} \cdot \vec{P}, \quad \rho_b = - \nabla \cdot \vec{P}.
\end{equation}
Since we have a sphere the normal vector is $\uvec{n} = \uvec{r}$, the surface charge density is also only on $r=R$, and $\vec{P}$ only have a radial component. Thus
\begin{align}
    \sigma_b &= \uvec{r} \cdot \vec{P} = \uvec{r} \cdot (kR^2 \uvec{r}) = kR^2\\
    \rho_b &= -\nabla \cdot \vec{P} = -\frac{1}{r^2} \frac{\partial}{\partial r} (kr^4) = -4kr
\end{align}
The charge densities are only non zero on or in the sphere and zero elsewhere.

\paragraph{(a) Answer:} The charge densities are
\begin{equation}
    \sigma_b = kR^2, \quad \rho_b = -4kr.
\end{equation}

\paragraph{(b) Solution:} To calculate the $\vec{E}$ field we can use Gauss's law. Adding a gaussian surface to the sketch
\begin{figure}[H]
    \centering
    \input{figures/gauss.pdf_tex}
    \caption{The sketch with and added gaussian surface.}\label{fig:gauss}
\end{figure}
More correctly we might write the charge densities
\begin{equation}
    \sigma_b(\vec{r}) = \begin{cases}
        kR^2 & r = R\\
        0 & \text{elsewhere}
    \end{cases}, \quad \text{and}\quad
    \rho_b(\vec{r}) = \begin{cases}
        -4kr & 0 \leq r < R\\
        0 & \text{elsewhere}
    \end{cases}\label{eq:charges}
\end{equation}
Now we can define 
\begin{equation}
    \rho(\vec{r}) = \rho_b(\vec{r}) + \sigma_b(\vec{r})
\end{equation}
Due to spherical symmetry we can write 
\begin{equation}
    \vec{E}(\vec{r}) = E(r)\uvec{r}.
\end{equation}
Using Gauss's law
\begin{equation}
    \nabla \cdot \vec{E}(\vec{r}) = \frac{\rho(\vec{r})}{\epsilon_0} \iff E(r) \oint_{\partial V} \dd a_r = \frac{1}{\epsilon_0}\int_V \rho(\vec{r'})\dd \tau'
\end{equation}
where $V$ is the volume we integrate over, that is the sphere. Thus
\begin{align}
    E(r) \int_{0}^{\pi} \int_{0}^{2\pi} r^2 \sin\theta \dd \theta \dd\varphi &= \frac{1}{\epsilon_0}\int_{0}^{\pi} \int_{0}^{2\pi} \int_{0}^{r}(\rho_b(\vec{r'}) + \sigma_b(\vec{r'})) (\dd r') (r' \dd \theta') (r' \sin\theta' \dd \varphi')\\
    E(r)r^2 4\pi &= \frac{4\pi}{\epsilon_0} \int_{0}^{r}(\rho_b(\vec{r'}) + \sigma_b(\vec{r'}))r'^2 \dd r'\\
    E(r) &= \frac{1}{\epsilon_0 r^2}\int_{0}^{r} (\rho_b(\vec{r'}) + \sigma_b(\vec{r'}))r'^2 \dd r'
\end{align}
Now we get two cases: $r < R$ and $r > R$
\paragraph{Case $r < R$:} In this case $\sigma_b(\vec{r})$ will always be zero by Eq. \eqref{eq:charges}. Thus
\begin{align}
    E(r) &= \frac{1}{\epsilon_0 r^2} \int_{0}^{r}\rho_b(\vec{r'})r'^2 \dd r' = -\frac{4k}{\epsilon_0 r^2} \int_{0}^{r}r'^3 \dd r'\\
    E(r) &= -\frac{4k}{\epsilon_0 r^2} \left[\frac{r'^4}{4}\right]_0^r = -\frac{k}{\epsilon_0} r^2
\end{align}
And thus we get that 
\begin{equation}
    \vec{E}(\vec{r})_\text{inside} = -\frac{k}{\epsilon_0} r^2 \uvec{r}
\end{equation}

\paragraph{Case $r > R$:} Rewriting $\sigma_b(\vec{r})$ using a delta function and using that $\rho_b(\vec{r})$ is zero outside the sphere we get
\begin{align}
    E(r) &= \frac{1}{\epsilon_0 r^2} \int_{0}^{r} (\rho_b(\vec{r}) + \delta(r' - R)kR^2)r'^2 \dd r'\\
    E(r) &= \frac{1}{\epsilon_0 r^2} \left( -4k\int_{0}^{R}r'^3 \dd r' + kR^2\int_{0}^{r} \delta(r' - R)r'^2 \dd r'\right)\\
    E(r) &= \frac{k}{\epsilon_0 r^2} \left( -4\left[\frac{r'^4}{4}\right]_0^R + R^4 \right) = \frac{k}{\epsilon_0 r^2} (-R^4 + R^4) = 0
\end{align}
Therefore the field outside is
\begin{equation}
    \vec{E}(\vec{r})_\text{outside} = \vec{0}
\end{equation}

\paragraph{(b) Answer:} We get the $\vec{E}$ field 
\begin{equation}
    \vec{E}(\vec{r}) = \begin{cases}\displaystyle
        -\frac{k}{\epsilon_0} r^2 \uvec{r} & r < R\\
        \vec{0} & r>R
    \end{cases}
\end{equation}

\paragraph{(c) Solution:}  We use the same gaussian surface as seen in Fig. \ref{fig:gauss}. We know have
\begin{equation}
    \nabla \cdot \vec{D} = \rho_f \iff \oint_{\partial V} \vec{D} \cdot \dd \vec{a} = \int_V \rho_f \dd\tau.
\end{equation}
However, we don't have any free charges so $\rho_f = 0$. Since we have a spherical geometry and the polarisation is spherically symmetrical we can write
\begin{equation}
    \vec{D}(\vec{r}) = D(r) \uvec{r}
\end{equation}
And thus the equation simplifies to
\begin{equation}
    D(r) r^2 4 \pi = 0 \iff D(r) = 0
\end{equation}
Now using that
\begin{equation}
    \vec{D} = \epsilon_0 \vec{E} + \vec{P}
\end{equation}
and since $\vec{P}$ is zero outside the sphere we have two cases: $r< R$ and $r> R$.
\paragraph{Case $r<R$:} Here we have
\begin{equation}
    \vec{0} = \epsilon_0 \vec{E}_\text{inside} + \vec{P} \iff \vec{E}_\text{inside} = -\frac{k}{\epsilon_0} r^2 \uvec{r}
\end{equation}

\paragraph{Case $r > R$:} Since $\vec{P}$ is zero in this region we have
\begin{equation}
    \vec{E}_\text{outside} = \vec{0}
\end{equation}
\paragraph{(c) Answer:} We see that the answer is the exact same as in (b) but with a lot less calculations. We need to be careful however, as we see in Exercise F.4, the polarisation must have spherical symmetry to be able to write $\vec{D}(\vec{r}) = D(r)\uvec{r}$.